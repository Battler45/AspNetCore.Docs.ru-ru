---
title: Отладка в ASP.NET Core Blazor
author: guardrex
description: Узнайте, как выполнять отладку приложений Blazor.
monikerRange: '>= aspnetcore-3.1'
ms.author: riande
ms.custom: mvc
ms.date: 01/16/2020
no-loc:
- Blazor
- SignalR
uid: blazor/debug
ms.openlocfilehash: 1b0035af48b82807a6ae14835a41a1ecbef06bb6
ms.sourcegitcommit: 9a129f5f3e31cc449742b164d5004894bfca90aa
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78648316"
---
# <a name="debug-aspnet-core-blazor"></a>Отладка в ASP.NET Core Blazor

[Дэниэл Рот (Daniel Roth)](https://github.com/danroth27)

[!INCLUDE[](~/includes/blazorwasm-preview-notice.md)]

Предоставляется *ранняя* поддержка для отладки Blazor WebAssembly с помощью средств разработки браузера в браузерах на основе Chromium (Chrome/Edge). Ведется работа над следующими задачами:

* Полная поддержка отладки в Visual Studio.
* Поддержка отладки в Visual Studio Code.

Возможности отладчика ограничены. Поддерживаются следующие сценарии:

* Установка и удаление точек останова.
* Пошаговое выполнение кода (`F10`) или возобновление выполнения кода (`F8`).
* На экране *Локальные переменные* просмотрите значения локальных переменных типа `int`, `string` и `bool`.
* См. стек вызовов, включая цепочки вызовов, которые поступают из JavaScript в .NET и из .NET в JavaScript.

Вы *не можете*:

* Просматривать значения локальных переменных, кроме `int`, `string` и `bool`.
* Просматривать значения свойств или полей класса.
* Просматривать значения, наводя на переменные указатель мыши.
* Вычислять выражения в консоли.
* Задействовать асинхронные вызовы.
* Выполнять большинство других обычных сценариев отладки.

Группа инженеров занимается разработкой дальнейших сценариев отладки.

## <a name="prerequisites"></a>Предварительные требования

Для отладки требуется один из следующих браузеров:

* Google Chrome (версии 70 и более поздних)
* Предварительная версия Microsoft Edge ([Edge Dev Channel](https://www.microsoftedgeinsider.com))

## <a name="procedure"></a>Процедура

# <a name="visual-studio"></a>[Visual Studio](#tab/visual-studio)

> [!WARNING]
> Поддержка отладки в Visual Studio находится на раннем этапе разработки. Отладка с помощью **F5** в настоящее время не поддерживается.

1. Запустите приложение Blazor WebAssembly в конфигурации `Debug` без отладки (**CTRL**+**F5** вместо **F5**).
1. Откройте свойства отладки приложения (последняя запись в меню **Отладка**) и скопируйте **URL-адрес приложения** по протоколу HTTP. Перейдите по адресу HTTP (а не HTTPS) приложения в браузере на основе Chromium (бета-версия Edge или Chrome).
1. Поместите фокус клавиатуры на приложение в окне браузера, а не на панель инструментов разработчика. Для этой процедуры лучше закрыть панель инструментов разработчика. После запуска отладки можно повторно открыть панель инструментов разработчика.
1. Нажмите следующее сочетание клавиш для Blazor:

   * `Shift+Alt+D` в Windows
   * `Shift+Cmd+D` в macOS

   Если отобразится сообщение **Не удается найти вкладку браузера для отладки**, см. раздел [Включение удаленной отладки](#enable-remote-debugging).
   
   После включения удаленной отладки:
   
   1\. Откроется новое окно браузера. Закройте прежнее окно.

   2\. Поместите фокус клавиатуры на приложение в окне браузера.

   3\. Нажмите сочетание клавиш для Blazor в новом окне браузера: `Shift+Alt+D` в Windows или `Shift+Cmd+D` в macOS.

   4\. В браузере откроется вкладка **DevTools**. **Снова выберите вкладку приложения в окне браузера.**

   Чтобы подключить приложение к Visual Studio, см. раздел [Присоединение к процессу в Visual Studio](#attach-to-process-in-visual-studio).

# <a name="net-core-cli"></a>[Интерфейс командной строки .NET Core](#tab/netcore-cli/)

1. Запустите приложение Blazor WebAssembly в конфигурации `Debug`, передав параметр `--configuration Debug` в команду [dotnet run](/dotnet/core/tools/dotnet-run): `dotnet run --configuration Debug`.
1. Перейдите к приложению по URL-адресу HTTP, показанному в окне оболочки.
1. Поместите фокус клавиатуры на приложение, а не на панель инструментов разработчика. Для этой процедуры лучше закрыть панель инструментов разработчика. После запуска отладки можно повторно открыть панель инструментов разработчика.
1. Нажмите следующее сочетание клавиш для Blazor:

   * `Shift+Alt+D` в Windows
   * `Shift+Cmd+D` в macOS

   Если отобразится сообщение **Не удается найти вкладку браузера для отладки**, см. раздел [Включение удаленной отладки](#enable-remote-debugging).
   
   После включения удаленной отладки:
   
   1\. Откроется новое окно браузера. Закройте прежнее окно.

   2\. Поместите фокус клавиатуры на приложение в окне браузера, а не на панель инструментов разработчика.

   3\. Нажмите сочетание клавиш для Blazor в новом окне браузера: `Shift+Alt+D` в Windows или `Shift+Cmd+D` в macOS.

---

## <a name="enable-remote-debugging"></a>Включение удаленной отладки

Если удаленная отладка отключена, в Chrome открывается страница ошибки **Не удается найти вкладку браузера для отладки**. На странице ошибки содержатся инструкции для запуска Chrome с открытым портом отладки, чтобы прокси-сервер отладки Blazor мог подключиться к приложению. *Закройте все экземпляры Chrome* и перезапустите Chrome.

## <a name="debug-the-app"></a>Отладка приложения

Когда Chrome будет запущен с включенной удаленной отладкой, откройте новую вкладку отладчика с помощью сочетания клавиш. Через некоторое время на вкладке **Источники** отобразится список сборок .NET в приложении. Разверните каждую сборку и найдите исходные файлы *CS*/*RAZOR*, доступные для отладки. Установите точки останова, переключитесь обратно на вкладку приложения, и точки останова будут достигнуты при выполнении кода. После попадания в точку останова выполняйте код пошагово (`F10`) или возобновите его обычное выполнение (`F8`).

Blazor предоставляет прокси-сервер отладки, который реализует протокол [Chrome DevTools](https://chromedevtools.github.io/devtools-protocol/) и дополняет его сведениями, относящимися к .NET. При нажатии сочетания клавиш для отладки Blazor указывает Chrome DevTools на прокси-сервер. Прокси-сервер подключается к окну браузера, для которого выполняется отладка (поэтому и надо было включить удаленную отладку).

## <a name="attach-to-process-in-visual-studio"></a>Присоединение к процессу в Visual Studio

Присоединение к процессу приложения в Visual Studio — это *временный* сценарий отладки для WebAssembly Blazor, пока отладка с помощью **F5** находится в разработке.

Чтобы присоединить процесс выполняющегося приложения к Visual Studio, выполните следующие действия.

1. В Visual Studio выберите пункт **Отладка** > **Присоединить к процессу**.
1. Для параметра **Тип соединения** выберите **WebSocket для протокола Chrome devtools (без проверки подлинности)** .
1. Для параметра **Целевой объект подключения** вставьте адрес HTTP (не HTTPS) приложения.
1. Выберите **Обновить**, чтобы обновить записи в разделе **Доступные процессы**.
1. Выберите процесс браузера для отладки и нажмите **Присоединить**.
1. В диалоговом окне **Выбрать тип кода** выберите тип кода для конкретного браузера, к которому вы подключаетесь (Edge или Chrome), а затем нажмите кнопку **ОК**.

## <a name="browser-source-maps"></a>Сопоставители с исходным кодом в браузере

Сопоставители с исходным кодом в браузере позволяют браузеру сопоставлять скомпилированные файлы с исходными файлами и обычно используются для отладки на стороне клиента. Однако Blazor в настоящее время не сопоставляет C# напрямую с JavaScript/WASM. Вместо этого Blazor выполняет интерпретацию IL в браузере, поэтому сопоставление с исходным кодом не актуально.

## <a name="troubleshoot"></a>Устранение неполадок

При возникновении ошибок вам поможет следующий совет:

На вкладке **Отладчик** откройте средства разработчика в браузере. В консоли выполните `localStorage.clear()`, чтобы удалить все точки останова.
