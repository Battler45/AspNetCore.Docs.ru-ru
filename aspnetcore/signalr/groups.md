---
title: Управление пользователями и группами в SignalR
author: bradygaster
description: Общие сведения о ASP.NET Core SignalR управлении пользователями и группами.
monikerRange: '>= aspnetcore-2.1'
ms.author: bradyg
ms.custom: mvc
ms.date: 11/12/2019
no-loc:
- SignalR
uid: signalr/groups
ms.openlocfilehash: 59e90042ecbaf936602643bbdc3965e036426b26
ms.sourcegitcommit: 3fc3020961e1289ee5bf5f3c365ce8304d8ebf19
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2019
ms.locfileid: "73963811"
---
# <a name="manage-users-and-groups-in-opno-locsignalr"></a>Управление пользователями и группами в SignalR

По [Бреннан Конрой](https://github.com/BrennanConroy)

SignalR позволяет отправлять сообщения всем соединениям, связанным с конкретным пользователем, а также именованным группам подключений.

[Просмотр или скачивание образца кода](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/signalr/groups/sample/) [(Загрузка)](xref:index#how-to-download-a-sample)

## <a name="users-in-opno-locsignalr"></a>Пользователи в SignalR

SignalR позволяет отсылать сообщения всем подключениям, связанным с конкретным пользователем. По умолчанию SignalR использует `ClaimTypes.NameIdentifier` из `ClaimsPrincipal`, связанного с подключением, в качестве идентификатора пользователя. Один пользователь может иметь несколько подключений к SignalR приложению. Например, пользователь может подключаться к рабочему столу, а также по телефону. Каждое устройство имеет отдельное SignalRное соединение, но все они связаны с одним и тем же пользователем. При отправке пользователю сообщения все соединения, связанные с этим пользователем, получают сообщение. Доступ к идентификатору пользователя для подключения можно получить с помощью свойства `Context.UserIdentifier` в центре.

Отправьте сообщение определенному пользователю, передав идентификатор пользователя в функцию `User` в методе Hub, как показано в следующем примере:

> [!NOTE]
> В идентификаторе пользователя учитывается регистр.

[!code-csharp[Configure service](groups/sample/hubs/chathub.cs?range=29-32)]

## <a name="groups-in-opno-locsignalr"></a>Группы в SignalR

Группа — это коллекция соединений, связанных с именем. Сообщения могут отправляться всем подключениям в группе. Группы — это рекомендуемый способ отправки на подключение или несколько подключений, так как группы управляются приложением. Соединение может быть членом нескольких групп. Это делает группы идеальными для чего-то вроде приложения для разговора, где каждая комната может быть представлена группой. Соединения можно добавлять в группы или удалять из них с помощью методов `AddToGroupAsync` и `RemoveFromGroupAsync`.

[!code-csharp[Hub methods](groups/sample/hubs/chathub.cs?range=15-27)]

Членство в группе не сохраняется при повторном подключении подключения. Соединение должно повторно присоединиться к группе, когда она будет восстановлена. Невозможно подсчитать членов группы, так как эта информация недоступна, если приложение масштабируется до нескольких серверов.

Чтобы защитить доступ к ресурсам при использовании групп, используйте функции [проверки подлинности и авторизации](xref:signalr/authn-and-authz) в ASP.NET Core. Если вы добавляете пользователей в группу только в том случае, если учетные данные действительны для этой группы, сообщения, отправленные в эту группу, будут отправляться только полномочным пользователям. Однако группы не являются функцией безопасности. Утверждения проверки подлинности имеют функции, которые не являются группами, например срок действия и отзыв. Если разрешение пользователя на доступ к группе отменено, необходимо вручную определить его и удалить из группы.

> [!NOTE]
> В именах групп учитывается регистр.

## <a name="related-resources"></a>Связанные ресурсы

* [Начало работы](xref:tutorials/signalr)
* [Центры](xref:signalr/hubs)
* [Публикация в Azure](xref:signalr/publish-to-azure-web-app)
