# <a name="response-compression-sample-application-aspnet-core-3x"></a>Пример приложения для сжатия ответа (ASP.NET Core 3. x)

В этом примере показано использование по промежуточного слоя сжатия ответа ASP.NET Core 3. x для сжатия HTTP-ответов. В примере демонстрируются поставщики gzip, Brotli и пользовательский алгоритм сжатия для текстовых и графических ответов, а также показано, как добавить тип MIME для сжатия. Пример ASP.NET Core 2. x см. в разделе [пример приложения для сжатия ответа (ASP.NET Core 2. x)](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/performance/response-compression/samples/2.x).

## <a name="examples-in-this-sample"></a>Включенные примеры

* `BrotliCompressionProvider`
  * `text/plain`
    * **/** -Lorem Ipsum ответ текстового файла в 2 044 байт, который сжимается до ~ 979 байт.
    * **/testfile1kb.txt** — ответ на текстовый файл в 1 033 байт, который сжимается до ~ 36 байт.
    * **/триккле** — ответ выдается как одиночные символы с интервалом в 1 секунду.
* `GzipCompressionProvider`
  * `text/plain`
    * **/** -Lorem Ipsum ответ текстового файла в 2 044 байт, который сжимается до ~ 927 байт.
    * **/testfile1kb.txt** — ответ на текстовый файл в 1 033 байт, который сжимается до ~ 47 байт.
    * **/триккле** — ответ выдается как одиночные символы с интервалом в 1 секунду.
  * `image/svg+xml`
    * **/баннер.СВГ** — ответ с изображением масштабируемой векторной графики (SVG) в 9 707 байт, который сжимается до ~ 4 459 байт.
* `CustomCompressionProvider`<br>Показывает, как реализовать пользовательский поставщик сжатия для использования с по промежуточного слоя.

Когда запрос включает `Accept-Encoding` сжатие заголовка и ответа, по промежуточного слоя автоматически `Vary: Accept-Encoding` добавляет заголовок в ответ. Заголовок указывает кэшам поддерживать несколько копий ответа на основе альтернативных `Accept-Encoding`значений, поэтому сжатые (gzip или Brotli) и несжатые версии хранятся в кэшах для систем, которые могут либо принять `Vary` сжатый или несжатый ответ.

## <a name="use-the-sample"></a>Использование примера

1. Выполните запрос с помощью [Fiddler](https://www.telerik.com/fiddler), [Firebug](https://getfirebug.com/)или [POST](https://www.getpostman.com/) `Accept-Encoding` в приложении без заголовка и запишите полезные данные ответа, размер ответа и заголовки ответа.
1. Добавьте заголовок `Accept-Encoding: gzip` или и запишите размер сжатого отклика и заголовков ответа. `Accept-Encoding: br` Размер ответа уменьшается, а `Content-Encoding` заголовок ответа включается по промежуточного слоя, что означает, что сжатие происходит с помощью gzip или Brotli. Если взглянуть на текст ответа на ответ Lorem Ipsum или **testfile1kb. txt** , вы увидите, что текст сжат и не читается.
1. `Accept-Encoding: mycustomcompression` Добавьте заголовок и запишите заголовки ответа. — Это пустая реализация, которая фактически не сжимает ответ, но можно создать настраиваемую оболочку потока сжатия `CreateStream()` для метода. `CustomCompressionProvider`
