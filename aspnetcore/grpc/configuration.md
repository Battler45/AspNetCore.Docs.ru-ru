---
title: Конфигурация gRPC для .NET
author: jamesnk
description: Узнайте, как настроить gRPC для приложений .NET.
monikerRange: '>= aspnetcore-3.0'
ms.author: jamesnk
ms.custom: mvc
ms.date: 09/05/2019
uid: grpc/configuration
ms.openlocfilehash: 3ef92f10d914ef9fa3e13a7bdd5c863bab297f57
ms.sourcegitcommit: 73e255e846e414821b8cc20ffa3aec946735cd4e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/03/2019
ms.locfileid: "71925210"
---
# <a name="grpc-for-net-configuration"></a>Конфигурация gRPC для .NET

## <a name="configure-services-options"></a>Настройка параметров служб

службы gRPC настраиваются с `AddGrpc` помощью в *Startup.CS*. В следующей таблице описаны параметры для настройки служб gRPC Services.

| Параметр | Default Value | Описание |
| ------ | ------------- | ----------- |
| `MaxSendMessageSize` | `null` | Максимальный размер сообщения в байтах, которое может быть отправлено с сервера. Попытка отправить сообщение, превышающее заданный максимальный размер сообщения, приведет к исключению. |
| `MaxReceiveMessageSize` | 4 МБ | Максимальный размер сообщения в байтах, которое может быть получено сервером. Если сервер получает сообщение, размер которого превышает это ограничение, вызывается исключение. Увеличение этого значения позволяет серверу принимать большие сообщения, но может негативно сказаться на потреблении памяти. |
| `EnableDetailedErrors` | `false` | Если `true`значение равно, подробные сообщения об исключениях возвращаются клиентам при возникновении исключения в методе службы. Значение по умолчанию — `false`. Параметр `EnableDetailedErrors` для `true` может привести к утечке конфиденциальной информации. |
| `CompressionProviders` | Файлами | Коллекция поставщиков сжатия, используемая для сжатия и распаковки сообщений. Пользовательские поставщики сжатия можно создать и добавить в коллекцию. Настроенные по умолчанию поставщики поддерживают сжатие **gzip** . |
| `ResponseCompressionAlgorithm` | `null` | Алгоритм сжатия, используемый для сжатия сообщений, отправленных с сервера. Алгоритм должен соответствовать поставщику сжатия в `CompressionProviders`. Чтобы алгоритм выполнял сжатие ответа, клиент должен указать, что он поддерживает алгоритм, отправив его в заголовке **GRPC-Accept-Encoding** . |
| `ResponseCompressionLevel` | `null` | Уровень сжатия, используемый для сжатия сообщений, отправленных с сервера. |

Параметры можно настроить для всех служб, предоставив делегаты параметров для `AddGrpc` вызова в: `Startup.ConfigureServices`

[!code-csharp[](~/grpc/configuration/sample/GrcpService/Startup.cs?name=snippet)]

Параметры отдельной службы переопределяют глобальные параметры, предоставленные в `AddGrpc` , и могут быть настроены с помощью: `AddServiceOptions<TService>`

[!code-csharp[](~/grpc/configuration/sample/GrcpService/Startup2.cs?name=snippet)]

## <a name="configure-client-options"></a>Настройка параметров клиента

Конфигурация клиента gRPC установлена на `GrpcChannelOptions`. В следующей таблице описаны параметры для настройки каналов gRPC.

| Параметр | Default Value | Описание |
| ------ | ------------- | ----------- |
| `HttpClient` | Новый экземпляр | Объект `HttpClient` , используемый для выполнения вызовов gRPC. Клиент может быть настроен для настройки пользовательского `HttpClientHandler`или добавления дополнительных обработчиков в конвейер HTTP для вызовов gRPC. Если значение `HttpClient` не указано, для канала создается `HttpClient` новый экземпляр. Он будет автоматически удален. |
| `DisposeHttpClient` | `false` | Если `true`задано значение `HttpClient` и указано, `HttpClient` то `GrpcChannel` экземпляр будет удален при удалении. |
| `LoggerFactory` | `null` | Объект `LoggerFactory` , используемый клиентом для записи сведений о вызовах gRPC. Экземпляр может быть разрешен из внедрения зависимостей или создан с помощью `LoggerFactory.Create`. `LoggerFactory` Примеры настройки ведения журнала см. в <xref:grpc/diagnostics#grpc-client-logging>разделе. |
| `MaxSendMessageSize` | `null` | Максимальный размер сообщения в байтах, которое может быть отправлено клиентом. Попытка отправить сообщение, превышающее заданный максимальный размер сообщения, приведет к исключению. |
| `MaxReceiveMessageSize` | 4 МБ | Максимальный размер сообщения в байтах, которое может быть получено клиентом. Если клиент получает сообщение, размер которого превышает это ограничение, вызывается исключение. Увеличение этого значения позволяет клиенту принимать большие сообщения, но может негативно сказаться на потреблении памяти. |
| `Credentials` | `null` | Экземпляр `ChannelCredentials`. Учетные данные используются для добавления метаданных проверки подлинности в вызовы gRPC. |
| `CompressionProviders` | Файлами | Коллекция поставщиков сжатия, используемая для сжатия и распаковки сообщений. Пользовательские поставщики сжатия можно создать и добавить в коллекцию. Настроенные по умолчанию поставщики поддерживают сжатие **gzip** . |

В приведенном ниже коде

* Задает максимальный размер сообщения для отправки и получения в канале.
* Создает клиент.

[!code-csharp[](~/grpc/configuration/sample/Program.cs?name=snippet&highlight=3-8)]

[!INCLUDE[](~/includes/gRPCazure.md)]

## <a name="additional-resources"></a>Дополнительные ресурсы

* <xref:grpc/aspnetcore>
* <xref:grpc/client>
* <xref:grpc/diagnostics>
* <xref:tutorials/grpc/grpc-start>
