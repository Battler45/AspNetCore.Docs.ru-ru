---
title: gRPC для конфигурации ASP.NET Core
author: jamesnk
description: Узнайте, как настроить gRPC для приложений ASP.NET Core.
monikerRange: '>= aspnetcore-3.0'
ms.author: jamesnk
ms.custom: mvc
ms.date: 09/05/2019
uid: grpc/configuration
ms.openlocfilehash: d6f095820271a3bb07e05e29299fbb82b042983b
ms.sourcegitcommit: f65d8765e4b7c894481db9b37aa6969abc625a48
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/06/2019
ms.locfileid: "70773681"
---
# <a name="grpc-for-aspnet-core-configuration"></a>gRPC для конфигурации ASP.NET Core

## <a name="configure-services-options"></a>Настройка параметров служб

В следующей таблице описаны параметры для настройки служб gRPC Services.

| Параметр | Default Value | Описание |
| ------ | ------------- | ----------- |
| `MaxSendMessageSize` | `null` | Максимальный размер сообщения в байтах, которое может быть отправлено с сервера. Попытка отправить сообщение, превышающее заданный максимальный размер сообщения, приведет к исключению. |
| `MaxReceiveMessageSize` | 4 МБ | Максимальный размер сообщения в байтах, которое может быть получено сервером. Если сервер получает сообщение, размер которого превышает это ограничение, вызывается исключение. Увеличение этого значения позволяет серверу принимать большие сообщения, но может негативно сказаться на потреблении памяти. |
| `EnableDetailedErrors` | `false` | Если `true`значение равно, подробные сообщения об исключениях возвращаются клиентам при возникновении исключения в методе службы. Значение по умолчанию — `false`. Параметр `EnableDetailedErrors` для `true` может привести к утечке конфиденциальной информации. |
| `CompressionProviders` | файлами | Коллекция поставщиков сжатия, используемая для сжатия и распаковки сообщений. Пользовательские поставщики сжатия можно создать и добавить в коллекцию. Настроенные по умолчанию поставщики поддерживают сжатие **gzip** . |
| `ResponseCompressionAlgorithm` | `null` | Алгоритм сжатия, используемый для сжатия сообщений, отправленных с сервера. Алгоритм должен соответствовать поставщику сжатия в `CompressionProviders`. Чтобы алгоритм выполнял сжатие ответа, клиент должен указать, что он поддерживает алгоритм, отправив его в заголовке **GRPC-Accept-Encoding** . |
| `ResponseCompressionLevel` | `null` | Уровень сжатия, используемый для сжатия сообщений, отправленных с сервера. |

Параметры можно настроить для всех служб, предоставив делегаты параметров для `AddGrpc` вызова в: `Startup.ConfigureServices`

[!code-csharp[](~/grpc/configuration/sample/GrcpService/Startup.cs?name=snippet)]

Параметры отдельной службы переопределяют глобальные параметры, предоставленные в `AddGrpc` , и могут быть настроены с помощью: `AddServiceOptions<TService>`

[!code-csharp[](~/grpc/configuration/sample/GrcpService/Startup2.cs?name=snippet)]

## <a name="configure-client-options"></a>Настройка параметров клиента

В следующей таблице описаны параметры для настройки каналов gRPC.

| Параметр | Default Value | Описание |
| ------ | ------------- | ----------- |
| `HttpClient` | Новый экземпляр | Объект `HttpClient` , используемый для выполнения вызовов gRPC. Клиент может быть настроен для настройки пользовательского `HttpClientHandler`или добавления дополнительных обработчиков в конвейер HTTP для вызовов gRPC. Если значение `HttpClient` не указано, для канала создается `HttpClient` новый экземпляр. Он будет автоматически удален. |
| `DisposeHttpClient` | `false` | Если `true`задано значение `HttpClient` и указано, `HttpClient` то `GrpcChannel` экземпляр будет удален при удалении. |
| `LoggerFactory` | `null` | Объект `LoggerFactory` , используемый клиентом для записи сведений о вызовах gRPC. Экземпляр может быть разрешен из внедрения зависимостей или создан с помощью `LoggerFactory.Create`. `LoggerFactory` Примеры настройки ведения журнала см. в <xref:fundamentals/logging/index>разделе. |
| `MaxSendMessageSize` | `null` | Максимальный размер сообщения в байтах, которое может быть отправлено клиентом. Попытка отправить сообщение, превышающее заданный максимальный размер сообщения, приведет к исключению. |
| `MaxReceiveMessageSize` | 4 МБ | Максимальный размер сообщения в байтах, которое может быть получено клиентом. Если клиент получает сообщение, размер которого превышает это ограничение, вызывается исключение. Увеличение этого значения позволяет клиенту принимать большие сообщения, но может негативно сказаться на потреблении памяти. |
| `Credentials` | `null` | Экземпляр `ChannelCredentials`. Учетные данные используются для добавления метаданных проверки подлинности в вызовы gRPC. |
| `CompressionProviders` | файлами | Коллекция поставщиков сжатия, используемая для сжатия и распаковки сообщений. Пользовательские поставщики сжатия можно создать и добавить в коллекцию. Настроенные по умолчанию поставщики поддерживают сжатие **gzip** . |

В приведенном ниже коде

* Задает максимальный размер сообщения для отправки и получения в канале.
* Создает клиент.

[!code-csharp[](~/grpc/configuration/sample/Program.cs?name=snippet&highlight=3-8)]

## <a name="additional-resources"></a>Дополнительные ресурсы

* <xref:grpc/aspnetcore>
* <xref:grpc/client>
* <xref:tutorials/grpc/grpc-start>
