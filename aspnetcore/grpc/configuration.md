---
title: gRPC для конфигурации ASP.NET Core
author: jamesnk
description: Узнайте, как настроить gRPC для приложений ASP.NET Core.
monikerRange: '>= aspnetcore-3.0'
ms.author: jamesnk
ms.custom: mvc
ms.date: 08/21/2019
uid: grpc/configuration
ms.openlocfilehash: 34eb598211c87fbb2c68ae5e041da50d02f543f7
ms.sourcegitcommit: 8b36f75b8931ae3f656e2a8e63572080adc78513
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/05/2019
ms.locfileid: "70310318"
---
# <a name="grpc-for-aspnet-core-configuration"></a>gRPC для конфигурации ASP.NET Core

## <a name="configure-services-options"></a>Настройка параметров служб

В следующей таблице описаны параметры для настройки служб gRPC Services.

| Параметр | Default Value | Описание |
| ------ | ------------- | ----------- |
| `MaxSendMessageSize` | `null` | Максимальный размер сообщения в байтах, которое может быть отправлено с сервера. Попытка отправить сообщение, превышающее заданный максимальный размер сообщения, приведет к исключению. |
| `MaxReceiveMessageSize` | 4 МБ | Максимальный размер сообщения в байтах, которое может быть получено сервером. Если сервер получает сообщение, размер которого превышает это ограничение, вызывается исключение. Увеличение этого значения позволяет серверу принимать большие сообщения, но может негативно сказаться на потреблении памяти. |
| `EnableDetailedErrors` | `false` | Если `true`значение равно, подробные сообщения об исключениях возвращаются клиентам при возникновении исключения в методе службы. Значение по умолчанию — `false`. Параметр `EnableDetailedErrors` для `true` может привести к утечке конфиденциальной информации. |
| `CompressionProviders` | gzip, Deflate | Коллекция поставщиков сжатия, используемая для сжатия и распаковки сообщений. Пользовательские поставщики сжатия можно создать и добавить в коллекцию. Настроенные по умолчанию поставщики поддерживают **gzip** и **Deflate** сжатие. |
| `ResponseCompressionAlgorithm` | `null` | Алгоритм сжатия, используемый для сжатия сообщений, отправленных с сервера. Алгоритм должен соответствовать поставщику сжатия в `CompressionProviders`. Чтобы алгоритм выполнял сжатие ответа, клиент должен указать, что он поддерживает алгоритм, отправив его в заголовке **GRPC-Accept-Encoding** . |
| `ResponseCompressionLevel` | `null` | Уровень сжатия, используемый для сжатия сообщений, отправленных с сервера. |

Параметры можно настроить для всех служб, предоставив делегаты параметров для `AddGrpc` вызова в: `Startup.ConfigureServices`

[!code-csharp[](~/grpc/configuration/sample/GrcpService/Startup.cs?name=snippet)]

Параметры отдельной службы переопределяют глобальные параметры, предоставленные в `AddGrpc` , и могут быть настроены с помощью: `AddServiceOptions<TService>`

[!code-csharp[](~/grpc/configuration/sample/GrcpService/Startup2.cs?name=snippet)]

## <a name="configure-client-options"></a>Настройка параметров клиента

В следующей таблице описаны параметры для настройки каналов gRPC.

| Параметр | Default Value | Описание |
| ------ | ------------- | ----------- |
| `HttpClient` | Новый экземпляр | Объект `HttpClient` , используемый для выполнения вызовов gRPC. Клиент может быть настроен для настройки пользовательского `HttpClientHandler`или добавления дополнительных обработчиков в конвейер HTTP для вызовов gRPC. По умолчанию создается `HttpClient` новый экземпляр. |
| `MaxSendMessageSize` | `null` | Максимальный размер сообщения в байтах, которое может быть отправлено клиентом. Попытка отправить сообщение, превышающее заданный максимальный размер сообщения, приведет к исключению. |
| `MaxReceiveMessageSize` | 4 МБ | Максимальный размер сообщения в байтах, которое может быть получено клиентом. Если сервер получает сообщение, размер которого превышает это ограничение, вызывается исключение. Увеличение этого значения позволяет серверу принимать большие сообщения, но может негативно сказаться на потреблении памяти. |
| `TransportOptions` | `null` | Параметры транспорта Настройте способ, с помощью которого канал вызывает службу gRPC. В настоящее время единственной реализацией является `HttpClientTransport` параметр, позволяющий указать значение, `HttpClient` используемое gRPC. |
| `Credentials` | `null` | Экземпляр `ChannelCredentials`. Учетные данные используются для добавления метаданных проверки подлинности в вызовы gRPC. |
| `CompressionProviders` | gzip, Deflate | Коллекция поставщиков сжатия, используемая для сжатия и распаковки сообщений. Пользовательские поставщики сжатия можно создать и добавить в коллекцию. Настроенные по умолчанию поставщики поддерживают **gzip** и **Deflate** сжатие. |

В приведенном ниже коде

* Задает максимальный размер сообщения для отправки и получения в канале.
* Создает клиент.

[!code-csharp[](~/grpc/configuration/sample/Program.cs?name=snippet&highlight=3-8)]

## <a name="additional-resources"></a>Дополнительные ресурсы

* <xref:grpc/aspnetcore>
* <xref:grpc/client>
* <xref:tutorials/grpc/grpc-start>
